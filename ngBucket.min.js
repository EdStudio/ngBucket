!function(){"use strict";function n(){var n=this;n.app="default",n.delimiter=".",n.$get=function(){return{prefix:"ngBucket",app:n.app,delimiter:n.delimiter}}}function e(n){return["$window","$rootScope","$log","ngBucketConfig",function(e,t,r,u){function a(n){try{var t=e[n];return t.setItem(n,n),t.getItem(n),t.removeItem(n),!0}catch(u){return r.warn("ngBucket::Current browser does not support "+n+"."),!1}}function o(n){e.addEventListener?e.addEventListener("storage",n):e.attachEvent("onstorage",n)}function i(){for(var n in p)c(k+w+y+w+n,p[n],I[n]||{});I=angular.copy(p)}function c(n,e,t){if(!angular.equals(e,t)){for(var r in t)r in e||d.removeItem(n+w+r);for(var r in e)r in t&&angular.equals(e,t[r])||d.setItem(n+w+r,"string"==typeof value?e[r]:angular.toJson(e[r]))}}function l(n,e){var t=n.split(w);t.length>=3&&k==t[0]&&y==t[1]&&e(v.use(t[2]),t[3])}function f(){return Date.now||(new Date).getTime()}function s(n,e,t){var r,u,a,o,i,c=function(){var l=f()-o;e>l&&l>0?r=setTimeout(c,e-l):(r=null,t||(i=n.apply(a,u),r||(a=u=null)))};return function(){a=this,u=arguments,o=f();var l=t&&!r;return r||(r=setTimeout(c,e)),l&&(i=n.apply(a,u),a=u=null),i}}var g=a(n),p={},v={use:function(n,e){return p[n]=angular.extend({},e||{},p[n])},flush:function(n){delete p[n]},deleteAll:function(){p={}},sync:function(){g&&i()}};if(g){var m=t.$new(!0),d=e[n],y=u.app,k=u.prefix,w=u.delimiter;m.buckets=p,o(function(n){var e=n.key;l(e,function(e,t){m.$apply(function(){n.newValue?e[t]=n.newValue:delete e[t]})})});for(var h=0,B=d.length;B>h;h++){var $=d.key(h);l($,function(n,e){n[e]=angular.fromJson(d.getItem($))})}var I=angular.copy(p);m.$watch(s(i,200))}return v}]}angular.module("ngBucket",[]).provider("ngBucketConfig",n).factory("LocalBuckets",e("localStorage")).factory("SessionBuckets",e("sessionStorage"))}();