!function(){"use strict";function e(){var e=this;e.app="default",e.delimiter=".",e.$get=function(){return{prefix:"ngBucket",app:e.app,delimiter:e.delimiter}}}function n(e){return["$window","$rootScope","$log","ngBucketConfig",function(n,t,r,u){function a(e){try{var t=n[e];return t.setItem(e,e),t.getItem(e),t.removeItem(e),!0}catch(u){return r.warn("ngBucket::Current browser does not support "+e+"."),!1}}function o(e){n.addEventListener?n.addEventListener("storage",e,!1):n.attachEvent("onstorage",e)}function i(e,n){var t=e.split(w);t.length>=3&&k==t[0]&&y==t[1]&&n(p.use(t[2]),t[3])}function l(){return Date.now||(new Date).getTime()}function c(e,n,t){var r,u,a,o,i,c=function(){var f=l()-o;n>f&&f>0?r=setTimeout(c,n-f):(r=null,t||(i=e.apply(a,u),r||(a=u=null)))};return function(){a=this,u=arguments,o=l();var f=t&&!r;return r||(r=setTimeout(c,n)),f&&(i=e.apply(a,u),a=u=null),i}}function f(){if(!angular.equals(v,$)){var e=e+w+y+w;for(var n in v)s(e+n,v[n],$[n]||{});$=angular.copy(v)}}function s(e,n,t){if(!angular.equals(n,t)){for(var r in t)r in n||d.removeItem(e+w+r);for(var r in n)r in t&&angular.equals(n,t[r])||d.setItem(e+w+r,"string"==typeof value?n[r]:angular.toJson(n[r]))}}var g=a(e),v={},p={use:function(e,n){return v[e]=angular.extend({},n||{},v[e])},flush:function(e){delete v[e]},deleteAll:function(){v={}},sync:function(){g&&f()}};if(g){var m=t.$new(!0),d=n[e],y=u.app,k=u.prefix,w=u.delimiter;m.buckets=v,o(function(e){console.log(e);var n=e.key;i(n,function(n,t){e.newValue?n[t]=e.newValue:delete n[t]})});for(var h=0,B=d.length;B>h;h++){var I=d.key(h);i(I,function(e,n){e[n]=angular.fromJson(d.getItem(I))})}var $=angular.copy(v);m.$watch(c(f,200))}return p}]}angular.module("ngBucket",[]).provider("ngBucketConfig",e).factory("LocalBuckets",n("localStorage")).factory("SessionBuckets",n("sessionStorage"))}();